# detection-engineering-microsoft
This repo shows how I design and validate detections using Microsoft Sentinel and Defender telemetry.

Detection → Alert → SOC Investigation Flow

This repository follows a production-aligned detection lifecycle where
detections are engineered, validated, and then operationalised for SOC
investigation.

The same telemetry flows through both detection engineering and SOC operations,
with clear ownership boundaries and no duplication of logic.

1. Detection Engineering (Source of Truth)

Purpose:
Design, test, validate, and promote security detections to a production-ready
state.

This repository defines:

Why a detection exists

How attacker behaviour was validated

Why the logic is reliable and low-noise

When a detection is ready for operational use

Detection lifecycle

Threat hypothesis is defined

Controlled attacker behaviour generates telemetry

Detection logic is engineered and iterated

Tuning and validation are performed

Detection is promoted for operational use

Example structure:

detections/
└── identity/
    └── suspicious-signin-impossible-travel/
        ├── hypothesis.md
        ├── atomic-tests.md
        ├── kql-rule.kql
        ├── tuning.md
        ├── validation.md
        └── promotion.md


This repository is the single source of truth for detections.

2. Alert Generation (Operational Handoff)

Once promoted:

The detection is enabled in Microsoft Sentinel

Realistic attacker telemetry triggers the rule

An alert is generated exactly as it would be in production

At this point, detection engineering ends and SOC operations begin.

3. SOC Operations (Investigation & Response)

Purpose:
Investigate alerts generated by production-ready detections.

SOC investigation artifacts are maintained in a separate SOC repository to
reflect operational ownership and investigative workflows.

Example structure:

incidents/
└── identity/
    └── impossible-travel-alert/
        ├── alert-summary.md
        ├── investigation.md
        ├── evidence/
        └── lessons-learned.md


Each incident references the originating detection:

Detection source:
https://github.com/yourname/detection-engineering/
detections/identity/suspicious-signin-impossible-travel


No detection logic is duplicated in SOC operations.

Design Principles

Detection Engineering is authoritative

SOC Operations consume detection outcomes

Telemetry is shared; responsibilities are not

Engineering and operations remain cleanly separated

Summary Rule

Detection Engineering defines how alerts are created
SOC Operations define how alerts are handled

```
detection-engineering-microsoft/
├── README.md

├── meta/
│   ├── data-sources.md
│   ├── naming-conventions.md
│   └── maturity-model.md

├── testing/
│   └── attack-simulations/
│       ├── atomic-red-team-setup.md        # install-only guide
│       ├── running-atomic-tests.md         # execution-only guide
│       ├── _template/
│       │   ├── attack.md
│       │   ├── telemetry.md
│       │   └── kql.md
│       ├── T1059_Command_and_Scripting/
│       ├── T1110_Brute_Force/
│       └── T1078_Valid_Accounts/

├── detections/
│   ├── _template/
│   │   └── detection.md                   # canonical detection template
│   ├── endpoint/
│   │   └── DE-ENDP-001-example-detection/
│   │       ├── rule.kql
│   │       └── detection.md
│   ├── identity/
│   │   └── DE-IDENT-001-example-detection/
│   │       ├── rule.kql
│   │       └── detection.md
│   ├── email/
│   ├── cloud/
│   └── network/

├── response/
│   └── _template.md

```
